---
firewall_v4_configure: true
firewall_v6_configure: false

firewall_v4_flush_chain_command: |
  iptables --flush
  iptables -t raw --flush
  iptables -t nat --flush
  iptables -t mangle --flush

firewall_v4_delete_chain_command: |
  iptables --delete-chain
  iptables -t raw --delete-chain
  iptables -t nat --delete-chain
  iptables -t mangle --delete-chain

firewall_v4_default_rules:
  001 default policies:
    - -P INPUT ACCEPT
    - -P OUTPUT ACCEPT
    - -P FORWARD DROP
  002 allow loopback:
    - -A INPUT -i lo -s 127.0.0.0/8 -d 127.0.0.0/8 -j ACCEPT
  003 allow ping replies:
    - -A INPUT -p icmp --icmp-type echo-request -j ACCEPT
    - -A OUTPUT -p icmp --icmp-type echo-reply -j ACCEPT
  100 allow established related:
    - -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
  200 allow ssh:
    - -A INPUT -p tcp --dport ssh -j ACCEPT
  999 drop everything:
    - -P INPUT DROP
firewall_v4_group_rules: {}
firewall_v4_host_rules: {}

firewall_v6_flush_chain_command: |
  ip6tables --flush
  ip6tables -t raw --flush
  ip6tables -t nat --flush
  ip6tables -t mangle --flush

firewall_v6_delete_chain_command: |
  ip6tables --delete-chain
  ip6tables -t raw --delete-chain
  ip6tables -t nat --delete-chain
  ip6tables -t mangle --delete-chain

firewall_v6_default_rules:
  001 default policies:
    - -P INPUT ACCEPT
    - -P OUTPUT ACCEPT
    - -P FORWARD DROP
  002 allow loopback:
    - -A INPUT -i lo -s ::1/128 -d ::1/128 -j ACCEPT
  003 allow ping replies:
    - -A INPUT -p icmpv6 --icmpv6-type echo-request -j ACCEPT
    - -A OUTPUT -p icmpv6 --icmpv6-type echo-reply -j ACCEPT
  100 allow established related:
    - -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
  200 allow ssh:
    - -A INPUT -p tcp --dport ssh -j ACCEPT
  999 drop everything:
    - -P INPUT DROP
firewall_v6_group_rules: {}
firewall_v6_host_rules: {}
